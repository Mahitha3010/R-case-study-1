---
title: "analyzing_SmartWatch_data_for_bellabeat"
author: "Mahitha Potti"
date: '2022-03-19'
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Bellabeat Case Study

By: Mahitha Potti

### **Mission:**

Bellabeat is a high-tech manufacturer of health-focused products for women. Bellabeat is a successful small company, but they have the potential to become a larger player in the global smart device market. Our task is to analyze data from a non-Bellabeat wearable smart device, the FitBit, to see if we can find any useful suggestions for Bellabeat's products and marketing.

### **Prepare:**

**About the data** Our FitBit data is stored as a public dataset on Kaggle.com. This data set was suggested by Bellabeat's founder, Urška Sršen and is organized into 18 different .csv files with both long and wide data related to the FitBit tracker.The data was collected by Amazon Mechanical Turk via a survey that collected FitBit data from 30 different users over 31 consecutive days.

**Credibility of the Data**
Amazon Mechanical Turk seems to be a credible crowd sourcing websites that outsources various business tasks including data entry and validation.

**Limitations of the Data**
The age of the data is over 5 years old. I will continue to work with this data because I was not able to find a newer dataset forBellabeat fitness tracker.

## Setting up R environment

Before getting started with the data, I install and load some packages that will help the data analysis process:

```{r}
options(repos = list(CRAN="http://cran.rstudio.com/"))
install.packages("dplyr")
install.packages("ggplot2")
install.packages("tidyverse")
install.packages("lubridate")

library("dplyr")
library("ggplot2")
library("tidyverse")
library("lubridate")
```

Importing the datasets I downloaded the data set from Kaggle.com to my desktop and previewed them all.

```{r}
activity=read.csv("C:\\Users\\User\\Desktop\\Fitabase Data 4.12.16-5.12.16\\dailyActivity_merged.csv")
calories=read.csv("C:\\Users\\User\\Desktop\\Fitabase Data 4.12.16-5.12.16\\dailyCalories_merged.csv")
sleep=read.csv("C:\\Users\\User\\Desktop\\Fitabase Data 4.12.16-5.12.16\\sleepDay_merged.csv")
weight=read.csv("C:\\Users\\User\\Desktop\\Fitabase Data 4.12.16-5.12.16\\weightLogInfo_merged.csv")
```

View the datasets

```{r}
head(activity)
head(calories)
head(sleep)
head(weight)
```

## **Data Cleanup and Organization (Process)**

### **Quick check of sample sizes**

To start, I check the data sets to see how may unique participants were included across the different categories of data:

```{r warning=FALSE}
#Check the number of unique participants n_distinct(activity$Id)
n_distinct(calories$Id)
n_distinct(sleep$Id)
n_distinct(weight$Id)
```

The activity and hourly steps data frames have 33 unique participants and the sleep data frame has 24 unique participants. The weight data frame only has 8 unique participants, which is not a large enough sample size for reliable analysis, and I've decided to exclude it.

#Checking for duplicates Next, I quickly check for duplicate rows of data:

```{r}
    #checking for duplicates
    sum(duplicated(activity))
    sum(duplicated(calories))
    sum(duplicated(sleep))
    
```

There are three duplicates in the sleep data frame, so I remove them.

```{r}
#use the distinct function to remove the duplicate rows:
sleep <- sleep %>% 
  distinct()

#check to make sure they're gone
sum(duplicated(sleep))

```

### **Fix formatting of dates**

When previewing the data frames, I noticed that all date columns are formatted as characters rather than dates. In some data frames, date and time are included in the same cell. I've decided to format all the dates as dates, put them in their own column, and put times in their own column when they are relevant. I don't put the times from the sleep data frame in their own column because they all have the same time of 12:00:00 AM. I also use the weekdays function to add a column that describes the day of the week for each data entry.

```{r}
#extract date from 'SleepDay' column and move to new column 'date', formatted as a date
sleep$date <- as.Date(str_trim(substr(sleep$SleepDay, 1, 9)), '%m/%d/%Y')

#make a new column called date with all the dates formatted as dates rather than characters.
activity$date <- as.Date(activity$ActivityDate,'%m/%d/%Y')

#add a new column called day_of_week using weekdays function
activity$day_of_week <- weekdays(activity$date)
```

**Add a new column to 'activity' that categorizes each day by activity level**

I have decided to categorize each day's data into one of four activity levels based on [these guidelines by medical author Pallavi Suyog Uttekar, MD.](https://www.medicinenet.com/how_many_steps_a_day_is_considered_active/article.htm) This *may* help use see notable differences among activity level groups later on in the data analysis process.

```{r}
#make a new data frame of daily activity with a new column for activity level
activity_categorized <- activity %>%
  mutate(activity_level = case_when(
    TotalSteps < 5000 ~ "1: Sedentary",
    TotalSteps >= 5000 & TotalSteps < 7500 ~ "2: Low active",
    TotalSteps >= 7500 & TotalSteps < 10000 ~ "3: Somewhat active",
    TotalSteps >= 10000 ~ "4: Active"))

head(activity_categorized)

```

Now I have a new data frame called activity_categorized that also describes each day of data as one of four activity levels, says which day of week it is, and has the date formatted correctly.

## **Data Analysis (Analyze / Share)**

### **Summary statistics**

To begin, running some summary statistics of the data frames gives us some quick information.

```{r paged.print=TRUE}
#summary statistics for activity data frame
activity_categorized %>%  
  select(TotalSteps, TotalDistance,SedentaryMinutes, LightlyActiveMinutes,
         FairlyActiveMinutes, VeryActiveMinutes) %>%
  summary()

#summary statistics for sleep data frame
sleep %>%  
  select(TotalSleepRecords,
         TotalMinutesAsleep,
         TotalTimeInBed) %>%
  summary()


```

### **Concerns with days with 0 steps recorded:**

After running summary statistics, I noticed the minimum number of steps tracked was 0. This seems off, as even highly sedentary people would take at least a few steps. I decide to check how many data entries consist of 0 total steps:

```{r}
#check number of data entries with 0 TotalSteps taken
sum(activity_categorized$TotalSteps == 0)
```

There are 77 rows with 0 steps tracked all day. Many of these days still at least have a record of calories burned that is well above 0. This leads us to a difficult decision: keep the data or exclude it from ur set? If we keep it, these days could possibly skew our analysis in an inaccurate way. If we exclude it, we could possibly be losing other insights into why 0 steps were recorded. After some thought and consultation with peers, and also running and checking both scenarios, I've decided to remove the 0 step days from the dataset and continue on. This may also prevent our zero step days from clouding any relationships we could find with other data points.

```{r}
#make new activity data frame that drops rows that have 100% sedentary minutes
activity_categorized <- subset(activity_categorized, TotalSteps > 0)

#check sample size, unique dates, and number of observations of the new data frame
n_distinct(activity_categorized$Id)
n_distinct(activity_categorized$date)
nrow(activity_categorized)
```

This new data frame still has 33 unique participants, data for all 31 days, but 863 unique observations instead of the 940 we had before because the 77 rows of data where days with 0 steps taken were removed. **I**

### 

**Run Summary Statistics Again With Zero Step Days Removed**

```{r}
#Run Summary Statistics Again With Zero Step Days Removed
#summary statistics for activity data frame
activity_categorized %>%  
  select(TotalSteps, TotalDistance,SedentaryMinutes, LightlyActiveMinutes,
         FairlyActiveMinutes, VeryActiveMinutes) %>%
  summary()

#summary statistics for sleep data frame
sleep %>%  
  select(TotalSleepRecords,
         TotalMinutesAsleep,
         TotalTimeInBed) %>%
  summary()
```

-   On average, participants took 8,319 steps a day.

-   Sedentary Minutes had more minutes recorded on average than Lightly Active, Fairly Active, and Very Active Minute combined. This may not be surprising because time sleeping is considered sedentary, and many people also have jobs that involve a lot of sedentary time.

-   The average daily activity entry had 955.8 minutes, or about 16.5 hours, of sedentary minutes.

-   On average, participants tracked 419.2 or about 6.98 hours asleep and 458.5 minutes or about 7.64 hours in bed.

### **Bar plot showing activity logs by activity level**

We can look at how many observations fell into each category:

```{r}
#Make bar plot that shows count of activity levels

ggplot(data=activity_categorized) +
  geom_bar(mapping=aes(x=activity_level, fill = activity_level)) +
  labs(title = "Number of Daily Activity Logs by Activity Level")

```

This visualization shows us that on most days, people actually fell into the active category. Sedentary days were the second most common by a count of over 50, followed by low-active and then somewhat-active days.

```{r}
activity_categorized %>%
  count(activity_level)
```

The above code just uses dplyr's count function to give us a number count of our activity groups. There were 226 sedentary days (26%), 171 low-active days (20%), 163 somewhat active days (19%), and 303 active days (35%).

```{r}
#make data frame that give us information for averages among activity levels
activity_averages <- activity_categorized %>%
  group_by(activity_level) %>%
  summarize(average_sedentary_minutes = mean(SedentaryMinutes), average_calories = mean(Calories))
head(activity_averages)
```

### 

**Sedentary Minutes Per Day Across Activity Levels**

We can also see how many sedentary minutes per day each of our four groups had on average:

```{r}
#make bar plot that shows average sedentary minutes per day across activity levels:
ggplot(data=activity_averages, aes(x=activity_level, y=average_sedentary_minutes, fill = activity_level)) + geom_bar(stat='identity', show.legend = FALSE) +
  theme(axis.text.x = element_text(angle = 0)) +
  labs(title = "Average Sedentary Minutes Spent Per Day by Activity Level")
```

We can see that on average, people spent more sedentary minutes on more sedentary days. Although this is very intuitive, it shows that our data confirms that taking more steps ususally means you spend less time in a sedentary state.

## **Relationships**

I will also check relationships between various variables in our data to see if we can find anything useful.

### 

**Total Steps Taken vs. Total Distance[¶](https://www.kaggle.com/code/palden/analyzing-fitbit-data-for-bellabeat#Total-Steps-Taken-vs.-Total-Distance)**

To start, I look at another intuitive relationship to see if the data confirms it. I use a scatter plot to visualize the relationship betwen total steps recorded and total distance recorded:

```{r}
#plot relationship between total steps and calories burned
ggplot(data = activity_categorized, aes(x = TotalSteps, y = Calories)) + geom_point() + geom_smooth() +
  labs(title = "Total Steps vs. Total Calories Burned")
```

As anticipated, we can see a strong positive correlation between total steps taken and total distance tracked. Although this relationship seems obvious, it is encouraging that the data confirms it.

## **Relationships between activity and sleep data**

### **Merge activity and sleep data**

To explore relationships between activity and sleep data, I want to merge the categorized daily activity and sleep data set by 'Id' and 'date'. I use an inner join and should keep in mind that this will include less data than the overall activity data set.

```{r}
activity_sleep_merged <- merge(sleep, activity_categorized, by=c("Id", "date"))

head(activity_sleep_merged)
```

**Total Steps vs. Time Asleep & Time in Bed vs. Time Asleep**

Now that we have our data merged, let's check how total number of steps taken related to our respondent's sleep and overall sedentary minutes tracked in a day.

```{r}
#plot relationship between total steps and time asleep
ggplot(data = activity_sleep_merged, aes(x = TotalSteps, y = TotalMinutesAsleep,color=activity_level)) + geom_point() + geom_smooth() +
  labs(title= "Total Steps vs. Total Minutes Asleep")

```

Our scatter plot with a curve above shows a slight negative correlation. There is a lot of variation in where our data points fall around our curve, which suggests it isn't the strongest correlation. I would be cautious to make any strong assertions about this relationship due to the weakness of the correlation and many other variables that we haven't explored yet that may affect the relationship. However, one suggestion could be that people have less time to sleep on days when they take more steps simply due to the fact that they spent more time being active.

## **Visualizing Data by Day of Week and Hour of Day**

### **Average Total Steps Taken Per Day By Day of Week**

We can also look at differences in our data based on day of the week and even hour of the day when it comes to steps.

```{r}
#Get averages by day of week
averages_by_day <- activity_categorized %>%
  group_by(day_of_week) %>%
  summarize(average_total_steps = mean(TotalSteps), average_calories = mean(Calories), average_distance = mean(TotalDistance), total_distance = sum(TotalDistance))

#to make the days of week show up in order when plotted
averages_by_day$day_of_week <- factor(averages_by_day$day_of_week, levels= c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))

#plot of average total steps by day of week
ggplot(data=averages_by_day, aes(x=day_of_week, y=average_total_steps, fill = day_of_week)) + geom_bar(stat='identity', show.legend = FALSE) +
  theme(axis.text.x = element_text(angle = 0)) +
  labs(title = "Average Total Steps Taken Per Day by Day of Week")
```

Not surprisingly, the least steps were taken, on average, late at night and early in the morning when most people are asleep. The hour of the day that had most steps taken on average was 18:00 or 6:00 pm, followed by 19:00 or 7 pm.

The fact that on average, steps taken throughout the day aren't evenly distributed should be taken into account if setting reminders to get active through a fitness tracker. For example, having the app notify you to take more steps early in the day may not be helpful. Instead, the app could notify you to take more steps when hourly steps taken are lower than averages halfway or 3/4 way through the day.

## **Action (Act)**

Based on the data we have and our analyses we can make some suggestions to Bellabeat:

**For products:**

-   We noticed a very strong correlation between time spent in bed and time asleep. Although this may seem somewhat obvious, the strength of the correlation is a good indicator that **reminders for users to get to bed at a reasonable time could help them get more sleep. Bellabeat could do this through notifications on their app if they don't already.**

-   Although more time in bed correlated with more time asleep, more sedentary minutes also correlated with less time asleep. This leads me to believe that **while users should spend more time in bed to get more sleep, they should also reduce sedentary time during their time out of bed. Bellabeat could make use of notifications to get active for people who want to improve sleep.**

-   With about 26% of days being considered sedentary (less than 5,000 steps taken), **a feature that anticipates sedentary days based on their steps taken so far and notifies them of this may benefit users who want to take more steps to be more active.**

-   More steps taken correlated to more tracked calories burned. Though this was expected, for users that want to lose weight, **Bellabeat's products could include step goals and reminders to encourage people to burn more calories.**

-   We noticed that Sunday, on average, was the day with the least steps taken. **For people who are aiming to take more steps, Bellabeat's app could also remind them to get out for some extra activity on Sunday. Even better, the Bellabeat app could make personalized reminders based on their individual activity trends.**

**For marketing:**

-   It is worth mentioning what our data did not show us. Our data gave us limited or no information on sleep quality, stress, menstrual cycles, or water intake. **These are all things that Bellabeat can track with their wide variety of products that integrate together, and could be highlighted as an advantage over the FitBit.**

-   Though we had 33 unique participants for data related to activity levels, we only had 24 unique participants for data related to sleep. It's possible that the FitBit isn't comfortable for users to sleep in. **We should look more into Bellabeat's leaf to see if the product's light weight and ability to be worn in a variety of ways makes it a more comfortable and desirable sleeping tracker than the FitBit.**

**Thank you for looking at my case study in R.**
